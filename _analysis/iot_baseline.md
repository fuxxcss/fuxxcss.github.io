---
title: "消费级物联网，从安全基线到攻击面"
excerpt: '从《消费级物联网安全基线》4.0到攻击面'

collection: analysis
category: xiot
permalink: /analysis/iot-baseline
tags: 
  - iot
  - xiaomi
  - attack surface

layout: single
read_time: true
author_profile: false
comments: true
share: true
related: true
---

## 《消费级物联网安全基线》4.0

2021年初，小米作为物联网安全领域的践行者，首次对外发布了《消费级物联网安全基线》，向物联网企业提供了一份开放的安全要求实施指南。小米内部及合作厂商依据此安全基线对各品类物联网产品进行安全评估和安全检测工作，我们真切地感受到在基线的指引下，物联网产品安全能力大幅度的提升[^1]。

![](../images/analysis/xiaomi/iot_baseline_cover.png)

2024年1月，小米正式对外发布《消费级物联网安全基线》4.0版本，4.0版本从行业发展以及落地实施角度出发[^1]：
1. 优化修改了 33 项安全要求描述，细化落地规范易于理解；
2. 新增 2 项针对 Android 系统的通用要求，并包含 1 个通用参考解决方案；
3. 新增 3 项技术通用解决方案和要求，细化米家安全芯片建议型号并补充完善米家三元组 Key 安全方案；
4. 补充新增 5 项针对门锁品类特殊安全要求（符合即将发版 GA 374-2023 要求），并包含 1 个通用参考解决方案；
5. 优化 PDF 易读性（通用 / 参考方案合并到正文、正文增加要求适用等级、目录跳转等）；

## 安全基线与攻击面

要想说清楚安全基线与攻击面，首先理解二者的定义：
- 攻击面[^2]，是指漏洞、途径或方法（有时称为攻击媒介）的总和，攻击者可以利用这些漏洞、途径或方法获取对网络或敏感数据进行未经授权访问或者实施网络攻击。
- 安全基线，是一个信息系统的最小安全保证。信息系统安全往往需要在安全付出成本与所能够承受的安全风险之间进行平衡, 而安全基线正是这个平衡的合理分界线。

由此可见，通过学习安全基线，可以根据安全防护策略推导出攻击面；通过学习攻击面，可以据此完善安全基线。本文从《消费级物联网安全基线》4.0出发，学习消费级物联网的安全基线与攻击面。

## 设备硬件

### 一、调试接口关闭、鉴权、输入输出

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 调试接口，如TX、RX、UART、JTAG、SWD、ADB | 中 | 鉴权 |
| | 中 | 输入输出控制 |
| | 高 | 永久关闭 |

<font color=Blue>中级策略</font> **鉴权**
设备正式版本固件默认关闭调试接口，需要开启时进行鉴权。有以下3种鉴权方式：
1. 云端鉴权，在芯片 efuse 烧录一机一密，需要登录账号密码从云端拉取设备刷机密码，在线刷工具输入并验证该密码正确后才可进行线刷。
2. 加密鉴权，如使用私有USB Dongle串接使用进行鉴权加密等。
3. 物理鉴权，飞线通联，需要调试时使用导线焊接到 PCB 的调试节点使调试接口电路通联；特殊操作，如特殊按键组合、设备倾斜通电等。

攻击面：
1. 云端设备刷机密码泄漏
2. 低安全等级设备，物理鉴权方案泄漏

<font color=Blue>中级策略</font> **输入输出控制**
关闭信息输入：开启调试接口时，关闭调试接口的信息输入，防止设备固件被篡改或本地存储的敏感信息被读取。

关闭敏感信息输出：开启调试接口时，log输出不包含用户与设备敏感信息（敏感安全参数如 key、token，个人敏感信息如 password、Wi-Fi密码等），如需输出完整数据流日志，需要将此类信息遮蔽展示（如：password ：********）。

攻击面：
...

<font color=Red>高级策略</font> **永久关闭**
从软件、硬件两个途径永久关闭调试接口，防止从调试接口getshell：
1. 根据 MCU/SoC 的芯片技术手册，在芯片 efuse 烧录对应的安全配置字段，一次性永久关闭调试接口。
2. 设备去除 PCB 板上的调试接口丝印，以防止逆向工程。

攻击面：
...

### 二、敏感数据加密、防篡改

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 敏感数据，如公私钥、证书，设备唯一标识符（如 SN、IMEI、Device ID） | 高 | 加密存储 |
| | 高 | 防篡改 |

<font color=Red>高级策略</font> **加密存储**
将敏感信息加密存储在存储芯片（flash、nand、emmc 等），加密方案可通过采用集成具备数据加密能力的安全芯片、TEE 或操作系统分区加密来实现。

攻击面：
1. 采用了加密措施，但是调试接口开启且未控制输入输出。

<font color=Red>高级策略</font> **防篡改**
设备用于存储保护、传输保护和鉴权的公私钥、证书等需要防止被篡改的敏感信息，和用于识别或验证设备身份合法性的设备唯一标识符，除加密存储外，应存储在设备不可被外部篡改的分区内，如 flash 只读分区、安全芯片或 TEE 中。


攻击面：
1. 采用了防篡改措施，但是调试接口开启且未控制输入输出。

### 三、芯片间通信加密

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 芯片间通信协议（UART/IIC/SPI/USB等）传输的数据 | 高 | 加密通信 |

<font color=Red>高级策略</font> **加密通信**
设备对芯片间通信协议传输的数据本身进行加密，有以下2种方案：
1. 采用安全芯片（SE）或可信执行环境（TEE）来确保加密密钥的安全性，并在 TEE 内实现敏感信息加解密和密钥管理等功能。
2. 对于未集成安全芯片和不支持可信执行环境的设备，设备关键MCU 之间首次上电后宜互相协商通信密钥（芯片间通过串口 ECC 生成公私钥对，计算临时密钥，生成随机数和挑战值，验证挑战值，验证通过后使用 LTK 做鉴权密钥），并存储在外部没有访问权限的存储分区。

攻击面：
...

### 四、安全启动

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 固件、Flash关键分区 | 中 | BL启动保护 |
| | 高 | 固件校验 |

<font color=Blue>中级策略</font> **bootloader启动保护**
设备 BootLoader 不应在系统启动前预留中断时间，Delay 需设置为 0，防止通过修改启动参数进入 SHELL 界面获得设备控制权。
当设备操作系统引导加载程序（Bootloader/U-Boot）启动异常后，设备操作系统应自动重启，避免启动异常后暴露操作系统引导加载控制台（Console）界面，以防止攻击者通过错误植入进入到控制台界面，来获得篡改设备启动参数的权限，从而控制设备。

<font color=Red>高级策略</font> **固件校验**
从设备上电开始，依次对固件（bootloader、kernel、rootfs）或 Flash 关键分区（如固件程序所在分区）进行合法加载校验，确保存储芯片中的系统合法性和完整性校验通过后才能正常启动。

攻击面：
...

## 设备软件

### 一、固件升级保护

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 固件 | 低 | 失败后恢复 |
| | 中 | 第三方组建更新 |
| | 高 | 升级包校验 |

<font color=Green>低级策略</font> **失败后恢复**
设备软件更新时可能遇到断电等特殊情况，导致设备升级失败。因此设备应具备 OTA 双分区备份机制，保障升级失败时能恢复到可用软件版本，防止升级失败损害设备可用性。

<font color=Blue>中级策略</font> **第三方组建更新**
设备使用到的第三方软件 / 库 / 开源代码应使用最新版本，不应使用老旧或已停止维护的版本，不应使用无 licence 或来源不明的代码或库，如特殊需求不能使用最新版本，应经过安全评估。在明确安全漏洞的情况下，应及时更新到最新修复版本。

<font color=Red>高级策略</font> **升级包校验**
设备固件升级前应先对固件包进行合法性校验，防止恶意固件刷入，或者固件降级攻击，导致旧版本可能存在的历史漏洞或安全风险重新暴露被利用。固件升级有3种途径：
1. OTA远程升级
2. 局域网升级
3. 设备通过硬件线刷，包括IAP线刷，ICP/ISP 线刷

固件升级前应先对固件包进行完整性哈希得到固件包摘要，再使用公私钥方式对摘要进行合法性签名和验签，确认升级包完整性与合法性再进行更新，以防止固件包被篡改或替换。

### 二、服务与端口最小化

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 服务与端口 | 中 | 最小化 |

<font color=Blue>中级策略</font> **最小化**
对服务、端口进行最小化处理：
1. 高风险服务与非必要端口，设备应默认关闭 FTP、SSH、Telnet、HTTP、ADB 等高风险管理服务或信息数据服务，如需开启应经过安全评估，也应关闭非数据交互与控制实现所必要的 IoT SDK 控制服务端口。
2. 设备端口协议：设备局域网端口应使用 IPv4 协议，设备互联网端口应按照业务功能需求选择使用 IPv4 或IPv6 协议，如设备无 IPv6 协议使用需求应关闭 IPv6 协议。

### 三、代码信息防泄漏

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 代码 | 低 | 不公开源代码 |
| | 低 | 正式版本 |

<font color=Green>低级策略</font> **不公开源代码**
设备相关代码库不应在未经允许的情况下上传至 Github、Gitee等公用代码仓库或百度网盘等公开、半公开服务，防止源代码泄露。

<font color=Green>低级策略</font> **正式版本**
设备应严格区分使用的小米 SDK、设备固件的版本类型，正式固件应基于用户 /release 版本编译，不应使用开发调试 /debug 版本编译正式版本，防止开发调试 /debug 版本中存在的特权接口、调试和产测等功能引入安全风险。

## 设备OS

### 一、权限控制

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 设备权限控制机制 | 低 | 密码管理 |
| | 中 | 防暴力破解 |
| | 中 | 文件系统权限控制 |
| | 高 | 外部存储执行权限控制 |

<font color=Green>低级策略</font> **密码管理**
对于有/无UI的登录验证，都需要预设高强度密码（长度 10-14 位，包含大写字母、小写字母、符号和数字其中三类字符）：
1. 无 UI 登录，嵌入式 Linux 系统默认用户（如 root、admin 等）需设置高强度密码，并保证一机一密，不应在代码中为所有设备写入相同密码或空密码。
2. 有 UI 登录，如果用户注册 / 登录设备的用户账户 / 管理后台预置了默认密码，则该密码应为随机生成且一机一密的高强度密码，并在用户首次登陆时强制要求修改默认密码；如果设备不为用户注册 / 登录设备的用户账户 / 管理后台预置默认密码，则设备应要求用户注册或首次登录时自行设置高强度密码。

<font color=Blue>中级策略</font> **防暴力破解**
不同品类的设备，防暴力破解策略不同：
1. 通用品类，需要在设备端登录密码的设备（仅路由器、门锁、电视、投影仪、带屏音箱等） ，其登录密码应具备防暴力破解机制，如验证码等人机交互机制、登录验证失败递增等待时间和登录验证失败超过一定次数锁定账号等。 用于累计登录验证失败次数的计数器应严格计算，防止通过按取消键可绕过计数等情况。
2. 门锁品类，未授权的所有技术认证手段（包含但不限于数字钥匙、PIN 钥匙、生物钥匙）在 5min 内连续错误输入次数累计之和达到 5 次后，锁端应给出报警提示信息，同时锁端应自动进入无效输入状态且至少持续 90s。

<font color=Blue>中级策略</font> **文件系统权限控制**
设备嵌入式 Linux 的基础文件系统（如 /etc/ 等存有启动项的目录）应使用只读文件系统（如 squashfs、cramfs），以防止攻击者在篡改运行状态的操作系统。
（由于 squashfs 不具备 flash 坏块处理机制，如果 NAND flash 设备的 OTA 等功能对坏块处理能力要求较高，可使用 UBI 文件系统，并且把设备根目录配置为只读，也满足安全要求。）

<font color=Red>高级策略</font> **外部存储执行权限控制**
设 备 嵌 入 式 Linux 操 作系统默认不应运行外部存储（SD 卡、U 盘、网络存储等）中程序或脚本。如有特殊需要，应进行公私钥签名验证，以防止系统被植入恶意软件或脚本。

### 二、输入验证

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 用户界面或 API 接口 | 高 | 输入验证 |

<font color=Red>高级策略</font> **输入验证**
设备应验证通过用户界面或 API 接口输入的数据，以防止设备执行外部恶意攻击代码。
根据验证方法包括过滤超出处理范围的数据、过滤和转义非预期的数据类型，及部署 fuzz 工具检测程序是否存在输入数据验证不足而出现的潜在漏洞等。

### 三、内存安全

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 漏洞利用缓解 | 低 | ASLR、PIE |
| | 低 | Stack Canary |
| | 低 | NX |
| | 低 | Stripped |

<font color=Green>低级策略</font> **ASLR、PIE**
嵌入式 Linux 系统的设备应开启地址空间布局随机化（ASLR）保护措施，以防止缓冲区溢出。
``` shell
kernel.randomize_va_space=2 > /etc/sysctl.conf
```
编译时应开启 PIE 应用基址随机加载保护选项，搭配ASLR。
``` shell
gcc -pie -fPIE
```

<font color=Green>低级策略</font> **Stack Canary**
在编译 Linux 程序代码时，应开启 Linux 程序的 CANARY 栈溢出保护选项。
``` shell
gcc -fstack-protector-all
```

<font color=Green>低级策略</font> **NX**
在编译 Linux 程序代码时，应开启 Linux 程序的 NX 栈不可执行保护选项。
``` shell
gcc -z noexecstack
```

<font color=Green>低级策略</font> **Stripped**
在编译 Linux 程序代码时，需使用 Strip 函数删除调试符号表，以提升逆向分析难度并减少程序体积。

## 设备通信

### 一、通用通信安全

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 通信输入输出、敏感数据 | 低 | 防信息泄漏 |
| | 中 | 通信限制 |
| | 中 | 通信认证 |
| | 中 | 密钥管理 |

<font color=Green>低级策略</font> **防信息泄漏**
设备网络接口不应在通信认证通过前返回非绑定过程必要的设备安全相关信息，防止攻击者利用特定配置或版本可能存在的安全漏洞绕过通信认证。设备安全相关信息包括：
1. 设备系统配置相关信息：设备配置信息、内核版本和软件版本等。
2. 设备登录认证失败的提示信息：如用户登录失败，应提示用户名或密码错误，而不是具体的错误原因如密码错误、密码长度错误等。

在通信传输中，应保护通信信道，对敏感信息额外加密：
1. 通信信道保护：设备应对与其他设备、应用和服务端通信的信道进行加密和完整性保护，并在会话结束时及时销毁会话密钥。
2. 敏感信息加密：设备应对与其他设备、应用和服务端通信中传输的关键安全参数（如私钥和密码等）、个人敏感信息和特殊类型的个人信息字段本身使用额外的安全加密算法进行加密传输。

<font color=Blue>中级策略</font> **通信限制**
通信协议、指令都应进行通信限制：
1. 非授权通信协议限制：设备与 APP、服务端、其他设备以及工厂 / 售后维修工具通过无线或有线通信使用的通信协议应经过安全评估，不应使用非授权通信协议。
2. 未绑定状态的受控指令限制：设备在未绑定时无法判断控制指令来源合法性，应拒绝执行除配网相关指令外的其他指令，防止设备配置被篡改或隐私信息泄露。
3. 敏感指令来源限制：高安全等级设备的敏感受控指令应仅支持通过蓝牙 /NFC 等近场通信协议经过严格的指令完整性、合法性和权限验证再执行，防止攻击者从互联网远程向设备下发非预期的敏感控制指令。

<font color=Blue>中级策略</font> **通信认证**
设备通信时应在数据传输之前进行双向认证，验证双方真实身份是否合法，检查控制权限是否与身份匹配，以防止越权或非授权控制：
1. 设备验证服务端：以太网设备通过米家 OTS 协议（基于 TLS/DTLS）与服务端通信时会先向 CA 校验服务端证书是否合法；蓝牙设备通过米家蓝牙安全认证协议绑定流程中的 OOB 信息验证服务端 /APP 是否合法。
2. 服务端验证设备：中、低安全等级设备，服务端通过校验设备的身份标识信息如三元组，判断设备身份是否合法；高安全等级设备，服务端通过验证设备安全芯片或 TEE 中存储的设备唯一证书判断证设备身份是否合法。

<font color=Blue>中级策略</font> **密钥管理**
在密钥生成阶段，设备不应该使用硬编码在代码中的密钥用于鉴权或传输被保护的关键安全参数，应采用一机一密 PSK 或通过 PSK密钥结合设备 SN、MAC、salt 等其他信息导出等方式生成密钥，防止通过固件逆向得到批量设备的传输安全保护或鉴权密钥。
对于密钥的用途，设备传输加密或鉴权的密钥应避免用于多种用途，如设备与 APP 在首次连接时的绑定鉴权密钥应仅用于绑定鉴权目的，鉴权通过后的传输会话密钥应使用绑定鉴权密钥结合随机数等其他信息导出的长期密钥来进行推衍。

### 二、以太网和无线网络安全

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 以太网、无线网络 | 低 | 防重放攻击 |
| | 中 | 通信加密 |
| | 中 | wifi接入点控制 |

<font color=Green>低级策略</font> **防重放攻击**
采用 HTTPS TLS1.2+ 传输协议默认支持的数据包序列号计数器防重放功能。

<font color=Blue>中级策略</font> **通信加密**
设备应使用加密的传输协议对通信进行加密，应采用 TLS（1.2+）传输协议的安全加密套件。避免因使用 MQTT、HTTP 等明文传输协议或包含的 SHA1、CBC 等弱加密套件而导致信息泄露或通信内容被篡改的风险。

设备使用 HTTPS 协议时，应对所有字段（域名、有效期等）进行严格的证书校验，完成设备对服务端的验证，不能忽略证书检查导致证书被替换的风险。设备应严格验证服务端证书合法性，不应使用如下参数跳过证书验证或忽略证书验证错误：

| 工具 / 库 | 参数使用建议 |
| :-: | :-: |
| curl | 不应使用 -k 参数 |
| wget | 不应使用 --no-check-certificate 参数 | 
| libcurl | 应将 CURLOPT_SSL_VERIFYPEER 和 CURLOPT_SSL_VERIFYHOST 设置为 True |

<font color=Blue>中级策略</font> **wifi接入点控制**
1. Wi-Fi 接入点口令：设备使用 Wi-Fi Direct 接入点与控制应用连接的功能应严格评估必要性，如确有必要，设备端 Wi-Fi Direct 接入点口令不应使用固定密码，或空密码，应遵循一机一密或者每次使用真随机生成密码，并显示在屏幕上（带屏设备）或在绑定时由用户提前设置并存储（无屏设备），以防止Wi-Fi 被非法接入。
2. Wi-Fi 接入点用途：设备建立的 Wi-Fi 接入点应只允许与设备本身通信，不应访问设备外部网络（如家庭网或互联网）， 以防止攻击者通过设备 Wi-Fi 向家庭网渗透。

### 三、蓝牙安全

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 蓝牙网络 | 低 | 防重放攻击 |
| | 中 | 通信加密 |
| | 中 | 指令校验 |

<font color=Green>低级策略</font> **防重放攻击**
采用米家蓝牙认证协议默认支持的帧计数器和加密功能，或采用标准 BLE SM（Security Manager）模块的数据包计数器（packetCounter）和链路层加密。

<font color=Blue>中级策略</font> **通信加密**
1. 蓝牙广播：部分设备通过蓝牙将传感器采集的数据进行广播传输，通过蓝牙网关解析广播内容进行设备联动，或根据广播数据作为控制指令，从而影响其他设备。此类设备的蓝牙广播应使用安全的通信协议，并使用绑定时产生的 beaconkey 对广播数据内容进行加密。
2. 蓝牙敏感信息通信：设备在使用 BLE 与控制应用（安卓）通信时，应对敏感信息内容本身进行应用层加密，以防止用户使用 BLE 将手机与其他智能设备配对进行数据传输时，手机上的所有应用都可以访问这两个设备间传输的数据。
3. 蓝牙 mesh 协议：蓝牙 mesh 设备应使用安全的通信协议与 mesh 设备、网关及手机进行双向认证，对传输的敏感数据使用会话密钥加密。米家的 mesh SDK已实现上述安全能力，接入米家产品按照指引接入即可符合此项要求。

<font color=Blue>中级策略</font> **指令校验**
1. 蓝牙控制指令合法性校验：设备执行蓝牙控制指令前应对指令来源合法性进行校验，如使用绑定时验证控制端身份，每次连接时身份验证通过后应与控制端协商会话密钥，使用会话密钥加密传输控制指令， 防止指令被篡改。
2. 芯片原厂未鉴权指令防护：设备使用蓝牙芯片厂商提供的OTA 例程指令前应判断控制应用的蓝牙绑定状态，只有在绑定状态下才可执行 OTA 指令。防止因例程中可能支持未授权指令控制设备的逻辑，从而导致设备拒绝服务（例如芯片重启、切换工作空间、进入DFU 升级模式等等）的风险。

### 四、Zigbee安全

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| Zigbee网络 | 低 | 防重放攻击 |

<font color=Green>低级策略</font> **防重放攻击**
设备应开启 Zigbee 协议帧计数器（framecounter）开启方法：设置 nwkAllFresh 为 TRUE。

### 五、Sub 1G 射频安全

Sub 1G 射 频 指 工 作 在 315MHz，433MHz，769-935MHz 等1GHz 以下频率的频段。此类频段一般没有通用的协议栈，需要自行设计开发组网、编解码和加密等功能。

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| Sub 1G 射频网络 | 低 | 防重放攻击 |
| | 中 | 密钥管理 |

<font color=Green>低级策略</font> **防重放攻击**
设备使用滚动码方式进行通信， 参考 keeloq、DST40、Hitag2 等业界成熟方案。

<font color=Blue>中级策略</font> **密钥管理**
设备射频通信密钥应通过发射器和接收器配对交换生成，不应作为硬编码预置密钥在代码中。

## 业务逻辑

| 基线对象 | 策略级别 | 具体策略 |
| :-: | :-: | :-: |
| 业务 | 中 | 绑定控制 |
| | 中 | 防信息泄漏 |
| | 高 | 权限控制 |
| | 高 | 安全监控 |

<font color=Blue>中级策略</font> **绑定控制**
1. 设备可绑定状态：未绑定设备上电 30 分钟后仍未绑定应关闭待绑定状态，待重新上电后重新进入绑定状态，避免设备始终允许接受绑定请求而被恶意绑定的风险。
2. 绑定确认：室内高安全级别设备绑定时宜在产品能力允许的情况下，要求用户在设备端进行绑定确认（针对无实体按钮的设备使用场景，需要用户主动确认）；室外交通工具和室外高安全级别设备（如滑板车、门铃、门锁、室外监控摄像机）应使用 OOB 绑定方式，防止设备被恶意绑定。绑定确认时应设置超时断开链接机制，确保不被恶意绑定链接。
3. 防重复绑定：对于具备重置能力的设备，应被重置后才可再次接受绑定请求，以防止被其他用户重复绑定或恶意绑定控制。
4. 强绑定关系：室外高安全级别设备应在云端将设备和账户建立强绑定关系，即云端记录设备 ID 与用户 ID 的绑定关系。设备绑定时应先验证云端记录，仅允许在云端没有绑定记录的设备的绑定请求，并且设备端重置不应清除云端绑定记录，仅当设备所有者（在云端有绑定记录的用户 ID）在控制端应用上主动解绑时才清除绑定关系，以防止设备重置后被非法绑定控制。

<font color=Blue>中级策略</font> **防信息泄漏**
1. 指纹识别信息：指纹识别算法应在设备端具备安全存储和安全运行环境的芯片内运行，防止指纹照片或特征在局域网或互联网传输造成用户敏感信息泄露。
2. 人脸识别信息：人脸识别算法应在设备端具备安全存储和安全运行环境的芯片内运行，防止人脸照片或特征在局域网或互联网传输造成用户敏感信息泄露。

<font color=Red>高级策略</font> **权限控制**
对于具备访问权限分享的设备，应建立分享权限分级机制，用户在分享设备时能以被分享人所需的最低权限分享设备，防止被分享人权限过高可任意修改设备配置等风险。权限分级可参考以下：
1. 设备所有者：即绑定设备的用户，具备最高权限，可访问设备的敏感及非敏感功能、修改设备所有设置、分享设备、解绑设备。
2. 设备管理员：被设备所有者通过设备分享授予权限，具备中等权限，可访问设备的敏感及非敏感功能、修改设备的非关键设置，可被设备所有者随时收回权限。
3. 设备使用者：被设备所有者通过设备分享授予权限，具备最低权限，可访问设备的非敏感功能，可被设备所有者随时收回权限。

<font color=Red>高级策略</font> **安全监控**
1. 报警事件管理：部分设备具备感知事件并报警的功能应默认开启，对于可能威胁用户人身安全、家庭安全或重大财产安全的报警事件，除设备端本地响应外，应同时通过 WI-Fi/ 蓝牙 /Zigbee 网关、移动通信网络等通道上报该报警事件到云端。
2. 设备日志安全监控：物联网平台应从设备端收集关键日志（如设备联网状态、使用状态、升级状态等），应将此类设备日志用于安全监控。通过统计和分析日志信息发现异常，从而发现潜在的设备或物联网平台安全风险。

## 参考文献
[^1]:消费级物联网安全基线，小米，https://github.com/MiSecurity/Cyber-Security-Baseline-for-Consumer-Internet-of-Things
[^2]:什么是攻击面，IBM，https://www.ibm.com/cn-zh/topics/attack-surface

